================================================================================
  âœ… WEBGOAT JWT CHALLENGE 1 - PROVEN WORKING SOLUTION
  Tested & Working: December 14, 2025
================================================================================

CHALLENGE: "Become Admin & Reset Votes"
TARGET: http://192.168.254.112:8001/WebGoat/JWT
USER: Tom

================================================================================
  ðŸŽ¯ THE EXACT SOLUTION THAT WORKS
================================================================================

STEP 1: Open DevTools and Find Cookie
--------------------------------------
1. Open WebGoat Challenge 1 page in browser
2. Press F12 to open Developer Tools
3. Click "Application" tab (at the top)
4. In left sidebar: Cookies > http://192.168.254.112:8001
5. Find the cookie named: "access_token"
6. Triple-click the VALUE to select all and copy

Example of what you'll see:
eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE3NjY1NjI5ODksImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0.xSkj4A15TtrWN7U1TfwNYDMKzmEnUq32vky6IOgjletmX42Ed28RQjVGaLTAVFT43W-1e3Joy0As5lN74SyWUA

STEP 2: Use This Attack Token
------------------------------
Your working attack token (ready to paste):

eyJhbGciOiJub25lIn0.eyJpYXQiOjE3NjY1NjI5ODksImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ.

This token contains:
âœ“ Header: {"alg":"none"}
âœ“ Payload: {"iat":1766562989,"admin":"true","user":"Tom"}  
âœ“ Signature: REMOVED (ends with a single dot)

STEP 3: Replace Cookie in DevTools
-----------------------------------
1. Still in DevTools > Application > Cookies
2. Find the "access_token" row in the table
3. Double-click on the VALUE column (not the Name)
4. Press Ctrl+A to select all the old token
5. Press Delete to clear it
6. Paste the new attack token (Ctrl+V)
7. Press Enter to save

STEP 4: Complete the Challenge
-------------------------------
Click the "Delete" button next to any user (Tom, Jerry, or Sylvester)
OR
Refresh the page (press F5)

âœ… Challenge will complete successfully!

================================================================================
  ðŸ”‘ WHY THIS WORKS (Understanding the Attack)
================================================================================

The Vulnerability:
------------------
WebGoat accepts JWT tokens with algorithm "none", which means:
- No signature verification is performed
- Server trusts the token payload without checking authenticity
- Attacker can set any claims (like admin: true)

The Attack: Algorithm Confusion
--------------------------------
Original Token:
- Algorithm: HS512 (HMAC-SHA512)
- Requires secret key to sign
- Signature: xSkj4A15TtrWN7U1...

Attack Token:
- Algorithm: none
- No signature required
- Signature: (empty, just a dot)

The server sees algorithm="none" and skips signature validation entirely!

================================================================================
  ðŸš« WHY JAVASCRIPT CONSOLE METHOD FAILED
================================================================================

You tried: document.cookie = 'access_token=...'
Result: Empty string ""

Reason: HttpOnly Cookie Flag
-----------------------------
The access_token cookie has the "HttpOnly" flag set, which means:
âœ— JavaScript cannot read it (document.cookie returns "")
âœ— JavaScript cannot write it (document.cookie = ... has no effect)
âœ“ Only the browser can send it in HTTP requests
âœ“ Only manual editing in DevTools works

This is a SECURITY FEATURE to protect against XSS (Cross-Site Scripting) attacks.

Solution: Edit manually in DevTools Application > Cookies tab

================================================================================
  ðŸ“‹ ALTERNATIVE: GENERATE TOKEN FOR DIFFERENT TIMESTAMP
================================================================================

If the timestamp in the attack token doesn't match your session, use PowerShell:

1. Open PowerShell terminal (your script should still be running)
2. Press: 6
3. Paste: YOUR_CURRENT_TOKEN (from DevTools cookies)
4. Press: Enter
5. The script generates an attack token with YOUR timestamp
6. Copy the generated token (automatically copied to clipboard)
7. Paste into DevTools cookies as shown in STEP 3 above

The PowerShell script does this:
- Decodes your current token
- Extracts the timestamp (iat)
- Changes admin: "false" â†’ "true"  
- Changes algorithm: "HS512" â†’ "none"
- Removes the signature
- Creates new token: eyJhbGciOiJub25lIn0.[your_payload].

================================================================================
  âš ï¸ COMMON MISTAKES TO AVOID
================================================================================

âŒ DON'T: Try to use document.cookie in JavaScript console
   âœ“ DO: Edit cookie manually in Application > Cookies

âŒ DON'T: Forget the trailing dot at the end of the token
   âœ“ DO: Token must end with: ...payload.

âŒ DON'T: Use uppercase "None" or "NONE"
   âœ“ DO: Use lowercase "none"

âŒ DON'T: Try to use Authorization header in fetch()
   âœ“ DO: Replace the cookie directly

âŒ DON'T: Try Option 2 (tampering without algorithm change)
   âœ“ DO: Use Option 6 (algorithm "none")

================================================================================
  ðŸ“Š TOKEN COMPARISON
================================================================================

BEFORE (Original Token):
------------------------
eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE3NjY1NjI5ODksImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0.xSkj4A15TtrWN7U1TfwNYDMKzmEnUq32vky6IOgjletmX42Ed28RQjVGaLTAVFT43W-1e3Joy0As5lN74SyWUA

Decoded:
Header:  {"alg":"HS512"}
Payload: {"iat":1766562989,"admin":"false","user":"Tom"}
Signature: xSkj4A15TtrWN7U1... (valid HMAC-SHA512)

AFTER (Attack Token):
---------------------
eyJhbGciOiJub25lIn0.eyJpYXQiOjE3NjY1NjI5ODksImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ.

Decoded:
Header:  {"alg":"none"}
Payload: {"iat":1766562989,"admin":"true","user":"Tom"}
Signature: (none)

Changes:
âœ“ Algorithm: HS512 â†’ none
âœ“ Admin: "false" â†’ "true"
âœ“ Signature: REMOVED

================================================================================
  ðŸŽ“ LESSONS LEARNED
================================================================================

1. JWT Security Best Practices:
   - Never accept algorithm "none" in production
   - Always validate the algorithm matches expected value
   - Use a whitelist of allowed algorithms
   - Implement proper signature verification

2. Cookie Security:
   - HttpOnly flag prevents JavaScript access (good for security)
   - But doesn't prevent manual editing in DevTools (user's own browser)
   - Use Secure flag to require HTTPS
   - Use SameSite to prevent CSRF

3. WebGoat Teaching Points:
   - This vulnerability is intentional for learning
   - Real applications should never have this flaw
   - Algorithm confusion attacks are a real threat
   - Always use well-tested JWT libraries

================================================================================
  ðŸš€ NEXT STEPS
================================================================================

Now that you've completed Challenge 1, move on to:

Challenge 2: "Admin Lost Password"
- Find or crack the admin password
- Use JWT analysis techniques

Challenge 3: "Buy Samsung Phone for Free"
- Manipulate price in JWT token
- Purchase for $0

Challenge 4: "Find Flag in Photo Comments"
- Use JWT tampering to access hidden comments
- Locate the flag

Use the same techniques:
1. Capture JWT token
2. Decode to understand structure
3. Modify relevant fields
4. Replace cookie in DevTools
5. Complete the action

================================================================================
  ðŸ“ž TROUBLESHOOTING
================================================================================

Problem: Challenge doesn't complete after replacing cookie
Solution: Try clicking "Delete" next to a different user, or refresh page

Problem: Cookie reverts to original value
Solution: Make sure you press Enter after pasting the new value

Problem: Can't find "access_token" in cookies
Solution: Make sure you're logged in and on the correct domain

Problem: Token format is wrong
Solution: Make sure token ends with a DOT: ...payload.

Problem: Still getting signature errors
Solution: You might be sending the token in wrong place. Use cookie, not header.

================================================================================
  âœ… SUCCESS CHECKLIST
================================================================================

â–¡ Opened DevTools (F12)
â–¡ Clicked Application tab
â–¡ Navigated to Cookies > http://192.168.254.112:8001
â–¡ Found "access_token" cookie
â–¡ Copied current value
â–¡ Double-clicked VALUE column
â–¡ Deleted old token
â–¡ Pasted attack token ending with dot
â–¡ Pressed Enter to save
â–¡ Clicked "Delete" button OR refreshed page
â–¡ Challenge completed!

================================================================================

Congratulations on completing JWT Challenge 1! ðŸŽ‰

This attack demonstrates the critical importance of proper JWT validation,
particularly around algorithm verification. In production, always:
- Use a JWT library that validates algorithms
- Never accept "none" algorithm
- Implement signature verification
- Use strong, unique secrets
- Rotate secrets regularly

Keep this knowledge for ethical security testing only!
