=== WebGoat CSRF - Basic GET Exercise Solution ===

OBJECTIVE:
Trigger the CSRF form from an external source while logged in to get a flag value.

WHAT IS CSRF?
Cross-Site Request Forgery (CSRF) is an attack that tricks a victim's browser into 
making unwanted requests to a web application where the victim is authenticated.

HOW THIS ATTACK WORKS:
1. Victim is logged into WebGoat (has valid session cookie)
2. Victim visits attacker's malicious website
3. Attacker's page includes code that makes a request to WebGoat
4. Browser automatically includes the victim's session cookie
5. WebGoat processes the request as if the victim intended it

=== SOLUTION METHODS ===

METHOD 1: Using HTML File (Most Realistic)
------------------------------------------
1. Make sure you're logged into WebGoat in your browser
2. Navigate to: Cross-Site Scripting (CSRF) -> Basic Get CSRF Exercise
3. Open the file: csrf_basic_get.html (in your browser - double-click it)
4. The page will automatically trigger the CSRF attack
5. Look for the flag value in the response
6. Copy the flag and paste it back in WebGoat to confirm

METHOD 2: Using PowerShell Script
----------------------------------
1. Open PowerShell
2. Navigate to c:\webgoat-scripts-1
3. Run: .\csrf_basic_get.ps1
4. When prompted, paste your JSESSIONID (from browser console: document.cookie)
5. The script will trigger the attack and display the flag
6. Copy the flag and paste it in WebGoat

METHOD 3: Simple Attack Page
-----------------------------
1. Open csrf_attack_simple.html in your browser while logged into WebGoat
2. The page automatically triggers multiple CSRF attack vectors
3. Check the page for the flag value displayed
4. Copy and confirm in WebGoat

METHOD 4: Manual Browser Method
--------------------------------
1. While logged into WebGoat, open a new browser tab
2. Paste this URL directly in the address bar:
   http://192.168.254.112:8001/WebGoat/csrf/basic-get-flag
3. Press Enter
4. You should see JSON response with the flag
5. Copy the flag value and paste it in WebGoat

METHOD 5: Using Browser Console
--------------------------------
1. In WebGoat, press F12 to open Developer Tools
2. Go to Console tab
3. Paste and run:
   fetch('http://192.168.254.112:8001/WebGoat/csrf/basic-get-flag', {
       method: 'GET',
       credentials: 'include'
   }).then(r => r.json()).then(d => console.log('Flag:', d.flag))
4. Check console output for the flag
5. Copy and confirm in WebGoat

=== COMMON ISSUES ===

"Sorry the solution is not correct"
- Make sure you copied the ENTIRE flag value (usually a number)
- Don't include quotes or extra spaces
- Make sure you triggered the attack while logged in
- Try refreshing the lesson page and triggering again

"No response" or "Connection refused"
- Verify WebGoat is running on http://192.168.254.112:8001
- Check you're logged into WebGoat
- Try accessing http://192.168.254.112:8001/WebGoat/start.mvc first

"CORS error" in console
- This is expected for CSRF attacks
- The attack may still work even with CORS errors
- Try using the HTML file methods instead

=== UNDERSTANDING THE VULNERABILITY ===

The vulnerable endpoint is:
GET http://192.168.254.112:8001/WebGoat/csrf/basic-get-flag

Why is it vulnerable?
- Uses GET method for state-changing operation
- No CSRF token required
- Relies only on session cookie for authentication
- Can be triggered from any external site

How to prevent CSRF:
- Use POST for state-changing operations
- Implement CSRF tokens (synchronizer token pattern)
- Check Referer/Origin headers
- Use SameSite cookie attribute
- Require re-authentication for sensitive actions

=== EXPECTED RESPONSE ===

When the attack succeeds, you should see JSON like:
{
    "lessonCompleted": false,
    "feedback": "...",
    "flag": 1234567890,
    "output": "..."
}

Copy the "flag" value (the number) and paste it in the confirmation field.

=== TROUBLESHOOTING ===

If none of the methods work:
1. Clear your browser cache and cookies
2. Log out and log back into WebGoat
3. Make sure you're on the correct lesson page
4. Check the browser console (F12) for any error messages
5. Verify the WebGoat version (you mentioned 2025.3)
6. Try using a different browser

The flag is typically a random numeric value generated when you trigger the 
GET request to /csrf/basic-get-flag while authenticated.
