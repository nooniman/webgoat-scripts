=== CSRF 405 Error - Solution Guide ===

ERROR: "Response status code does not indicate success: 405"

WHAT THIS MEANS:
The 405 error means "Method Not Allowed". The WebGoat CSRF endpoint 
is specifically designed to ONLY accept requests from a browser context,
not from command-line tools like PowerShell or curl.

This is actually INTENTIONAL - it's testing that you understand how 
CSRF attacks work in real browsers!

=== WORKING SOLUTIONS ===

‚úÖ SOLUTION 1: Use the Browser-Based HTML File (BEST METHOD)
---------------------------------------------------------------
1. Make sure you're logged into WebGoat at http://192.168.254.112:8001
2. Keep that browser window/tab open
3. Open this file in the SAME browser: csrf_get_flag.html
   (Just double-click it, or drag-drop into browser)
4. Click any of the "Attack" buttons (Method 1 recommended)
5. The flag will appear on the page
6. Copy the flag and paste it in WebGoat

WHY THIS WORKS:
- Your browser has the WebGoat session cookie
- The HTML page runs JavaScript in your browser
- The fetch/request includes your cookies automatically
- WebGoat accepts it because it looks like a real browser request

‚úÖ SOLUTION 2: Direct Browser Navigation
-----------------------------------------
1. Make sure you're logged into WebGoat
2. In the SAME browser, open a new tab
3. Type/paste this URL in address bar:
   http://192.168.254.112:8001/WebGoat/csrf/basic-get-flag
4. Press Enter
5. You'll see JSON with the flag
6. Copy the flag number
7. Go back to WebGoat and paste it

‚úÖ SOLUTION 3: Browser Console (Developer Tools)
-------------------------------------------------
1. In WebGoat, press F12 (opens Developer Tools)
2. Click on the "Console" tab
3. Paste this code and press Enter:

fetch('http://192.168.254.112:8001/WebGoat/csrf/basic-get-flag', {
    credentials: 'include'
}).then(r => r.json()).then(d => {
    console.log('üéâ FLAG:', d.flag);
    alert('Flag: ' + d.flag);
})

4. The flag will appear in the console and in an alert box
5. Copy it and paste in the confirmation field

=== WHY POWERSHELL DOESN'T WORK ===

PowerShell/curl requests:
‚ùå Don't include browser cookies automatically the right way
‚ùå Don't have the same headers as a real browser
‚ùå WebGoat can detect it's not a browser request
‚ùå Returns 405 Method Not Allowed

Browser requests:
‚úÖ Include cookies automatically
‚úÖ Have proper browser headers
‚úÖ Look like legitimate user requests
‚úÖ This is what CSRF exploits!

=== QUICK START ===

Fastest way to get the flag:
1. Log into WebGoat
2. Open: csrf_get_flag.html in the same browser
3. Click "Attack via Fetch API"
4. Copy the flag that appears
5. Paste in WebGoat
6. Done! ‚úÖ

=== UNDERSTANDING CSRF ===

CSRF (Cross-Site Request Forgery) works because:
- Websites trust requests that include valid session cookies
- Browsers automatically send cookies with requests
- A malicious website can trigger requests to other sites
- The victim's browser sends their cookies without them knowing

The csrf_get_flag.html file simulates a malicious website that
exploits this vulnerability. In a real attack:
- Victim logs into their bank (gets session cookie)
- Victim visits attacker's website
- Attacker's page sends request to bank
- Browser includes victim's bank cookie
- Bank processes it as if victim intended it
- Money gets transferred, settings changed, etc.

That's why modern sites use:
- CSRF tokens (unique per request)
- SameSite cookie attributes
- POST instead of GET for sensitive actions
- Origin/Referer header checking

Good luck! üöÄ
